---
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import type { Contact as Props } from '~/types';

const {
  title,
  subtitle,
  medidas=[],  
  inputs = [],
  disclaimer,
  description,
  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
} = Astro.props;

const quantities = [50, 100, 200, 500, 1000];
---

<WidgetWrapper
  id={id}
  isDark={isDark}
  containerClass={`max-w-7xl mx-auto ${classes?.container ?? ''}`}
  bg={bg}
>
  <div class="flex flex-col max-w-xl mx-auto rounded-lg backdrop-blur border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-900 shadow p-4 sm:p-6 lg:p-8 w-full">
    <form id="contact-form" method="POST" action="/api/send-email">
      <!-- Nombre -->
      {inputs?.map(input => (
        <div class="relative mb-4">
          <label for={input.name} class="block text-sm font-medium text-gray-700">{input.label}</label>
          <input id={input.name} name={input.name} type={input.type} required class="form-input border border-gray-300 rounded-full py-2 px-4 w-full focus:outline-none focus:ring focus:border-blue-300" />
        </div>
      ))}

      <!-- Tamaño del calendario -->
      {medidas?.length > 0 && (
        <div class="text-center mb-4">
          <label for="tamaño" class="block text-sm font-bold text-gray-700 mb-2">Tamaño del calendario *</label>
          <div class="flex justify-center gap-4 flex-wrap">
            {medidas.map(size => (
              <button type="button" class="size-btn py-2 px-4 rounded-full border border-gray-300" data-value={size}>
                {size}
              </button>
            ))}
          </div>
          <input type="hidden" name="tamaño" id="size-input" required />
          <span class="error-message hidden">Selecciona un tamaño.</span>
        </div>
      )}

      <!-- Cantidad con botones -->
      <div class="text-center mb-4">
        <label for="cantidad" class="block text-sm font-bold text-gray-700 mb-2">Cantidad *</label>
        <div class="flex justify-center gap-4 flex-wrap">
          {quantities.map(quantity => (
            <button type="button" class="quantity-btn py-2 px-4 rounded-full border border-gray-300" data-value={quantity}>
              {quantity}
            </button>
          ))}
        </div>
        <input type="hidden" name="cantidad" id="quantity-input" required />
        <span class="error-message hidden">Selecciona una cantidad.</span>
      </div>

      <!-- Aceptación de política de privacidad -->
      <div class="mb-4">
        <label class="flex items-center">
          <input type="checkbox" name="politicaPrivacidad" id="politicaPrivacidad" required class="mr-2" />
          Acepto la política de privacidad *
        </label>
        <span class="error-message hidden">Debes aceptar la política de privacidad.</span>
      </div>

      <!-- Botón de envío -->
      <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary">Solicitud de precio</button>
      </div>
    </form>
  </div>
</WidgetWrapper>
